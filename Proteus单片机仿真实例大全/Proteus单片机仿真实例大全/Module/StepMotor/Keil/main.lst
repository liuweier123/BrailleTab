C51 COMPILER V8.05a   MAIN                                                                 08/09/2007 15:33:26 PAGE 1   


C51 COMPILER V8.05a, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN main.obj
COMPILER INVOKED BY: C:\Keil\C51\BIN\C51.EXE source\main.c BROWSE INCDIR(.\include) DEBUG OBJECTEXTEND PRINT(.\main.lst)
                    - OBJECT(main.obj)

line level    source

   1          //*************************************************************************************************
   2          //*************************************************************************************************
   3          //**<程序名>：步进电机驱动                                                                                                                                               **
   4          //**<功能>：通过编程输出脉冲来控制步进电机转动。                                                                                                 **
   5          //**<版本说明>：这是第1.0版，电机可以正向转动，但无法控制。                                                                      **
   6          //**<作者>：程沛                                                                                                                                                                 **
   7          //**<完成时间>：2007年8月9日                                                                                                                                     **
   8          //**<联系方式>：superyongzhe@163.com                                                                                                                     **
   9          //*************************************************************************************************
  10          //*************************************************************************************************
  11          
  12          //*************************************************************************************************
  13          //*                                                                                                                                                                                               *
  14          //*                      ******************************头文件及宏定义**************************                           *
  15          //*                                                                                                                                                                                               *
  16          //*************************************************************************************************
  17          #include <at89x51.h>
  18          
  19          #define TIME0H 0xFC
  20          #define TIME0L 0x18                     //定时器0溢出时间：1ms
  21          
  22          
  23          //*************************************************************************************************
  24          //*                                                                                                                                                                                               *
  25          //*                      ******************************全局变量*********************************                          *
  26          //*                                                                                                                                                                                               *
  27          //*************************************************************************************************
  28          
  29          unsigned char uc_StepSelect=0;             //励磁电流选择序号。
  30          
  31          unsigned int ui_ChangeCount=0;             //改变励磁电流，定时器计数。
  32          
  33          unsigned char uca_MotorStep[]={0x03,0x02,0x06,0x04,0x0C,0x08,0x09,0x01};
  34                                                                                     //励磁电流数组。
  35          
  36          
  37          //*************************************************************************************************
  38          //*                                                                                                                                                                                               *
  39          //*                       ********************************主函数******************************                            *
  40          //*                                                                                                                                                                                               *
  41          //*************************************************************************************************
  42          void main()
  43          {
  44   1      
  45   1              TMOD=0x01;
  46   1              TH0=TIME0H;
  47   1              TL0=TIME0L;
  48   1              TR0=1;
  49   1              ET0=1;
  50   1      
  51   1              EA=1;
  52   1              
  53   1              while(1);
  54   1      }
C51 COMPILER V8.05a   MAIN                                                                 08/09/2007 15:33:26 PAGE 2   

  55          
  56          
  57          //*************************************************************************************************
  58          //*                                                                                                                                                                                               *
  59          //*                             ******************************定时器0，用于电机励磁******************                     *
  60          //*                                                                                                                                                                                               *
  61          //*************************************************************************************************
  62          void vTimer0() interrupt 1
  63          {
  64   1              if(ui_ChangeCount==100)                                         //可通过此句改变速度。
  65   1                      {
  66   2                      P1=uca_MotorStep[uc_StepSelect];
  67   2      
  68   2                      if(uc_StepSelect<7)
  69   2                              uc_StepSelect++;
  70   2                      else 
  71   2                              uc_StepSelect=0;
  72   2              
  73   2                      ui_ChangeCount=0;
  74   2                      }
  75   1              else
  76   1                      ui_ChangeCount++;
  77   1      
  78   1              TH0=TIME0H;
  79   1              TL0=TIME0L;
  80   1      } 


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =     85    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     11    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
