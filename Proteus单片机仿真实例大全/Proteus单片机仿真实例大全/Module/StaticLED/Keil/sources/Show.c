//*************************************************************************************************
//*																								  *
//*			  ********************************主函数******************************				  *
//*																								  *
//*************************************************************************************************

//*************************************************************************************************
//*																								  *
//*			 ******************************头文件及宏定义**************************				  *
//*																								  *
//*************************************************************************************************
#include <at89x51.h>


//*************************************************************************************************
//*																								  *
//*			  ********************************全局变量******************************			  *
//*																								  *
//*************************************************************************************************
unsigned  char code uca_LEDCode[]=
					{0x03,0x9F,0x25,0x0D,0x99,0x49,0x41,0x1F,0x01,0x09};
					//74LS164编码：0,1,2,3,4,5,6,7,8,9


//*************************************************************************************************
//*																								  *
//*			  ***********************把一个4位数通过串口输出给LED**********************			  *
//*																								  *
//*************************************************************************************************
void vShowNumber(unsigned int uiNumber)
{
	unsigned char ucSelect;
	unsigned char ucaNumber[4];
	unsigned char ucNumFront;

	if(uiNumber>9999)
		uiNumber=9999;
	ucaNumber[0]=uiNumber/1000;								 //最高位
	ucaNumber[1]=(uiNumber-1000*(int)ucaNumber[0])/100;
	ucaNumber[2]=(uiNumber-1000*(int)ucaNumber[0]-100*(int)ucaNumber[1])/10;
	ucaNumber[3]=(uiNumber-1000*(int)ucaNumber[0]-100*(int)ucaNumber[1]-10*(int)ucaNumber[2]);

	for(ucNumFront=0;ucNumFront<3;ucNumFront++)				//查找非零首位。
		if(ucaNumber[ucNumFront]!=0)
			break;

	for(ucSelect=0;ucSelect<4;ucSelect++)					//向串口输出数据。
		{
		if(ucSelect<ucNumFront)
			SBUF=0xFF;
		else
			SBUF=uca_LEDCode[ucaNumber[ucSelect]];

		while(TI==0);
		TI=0;
		}
}